<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <title>KLMZ MUSIC</title>
  <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
  <link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css" rel="stylesheet">
</head>
<body class="bg-gray-900 text-white flex flex-col min-h-screen">

  <!-- HEADER -->
  <header class="bg-black p-4 flex justify-between items-center shadow-md">
    <button onclick="goBack()" class="text-lg px-2">‚¨ÖÔ∏è</button>
    <h1 class="text-2xl font-bold text-green-500">Albums</h1>
    <div id="auth-section" class="space-x-4 flex items-center">
      <button id="admin-key" onclick="toggleLogin()" class="text-xl">üîë</button>
    </div>
  </header>

  <!-- MAIN -->
  <main class="flex-1 p-6 overflow-y-auto">
    <div id="login-section" class="max-w-sm mx-auto bg-gray-800 p-6 rounded-xl shadow-lg hidden">
      <h2 class="text-xl font-bold mb-4">Iniciar sesi√≥n</h2>
      <input id="email" type="email" placeholder="Correo" class="w-full mb-2 p-2 rounded text-black">
      <input id="password" type="password" placeholder="Contrase√±a" class="w-full mb-2 p-2 rounded text-black">
      <button onclick="login()" class="w-full bg-green-500 p-2 rounded hover:bg-green-600">Entrar</button>
    </div>

    <div id="albums" class="grid grid-cols-3 gap-4"></div>
  </main>

  <!-- PLAYER (FOOTER) -->
  <footer id="player" onclick="openPlayerOverlay()" class="bg-black p-4 shadow-lg fixed bottom-0 w-full">
    <div class="flex items-center justify-between">
      <div class="flex items-center space-x-3">
        <img id="player-cover" src="" alt="cover" class="w-12 h-12 object-cover rounded-full">
        <div>
          <p id="player-song" class="font-bold">No hay canci√≥n</p>
          <p id="player-album" class="text-sm text-gray-400">Selecciona una canci√≥n</p>
        </div>
      </div>
      <div class="flex space-x-4 text-3xl">
        <button onclick="prevSong(event)">‚èÆÔ∏è</button>
        <button onclick="togglePlay(event)" id="play-btn">‚ñ∂Ô∏è</button>
        <button onclick="nextSong(event)">‚è≠Ô∏è</button>
      </div>
    </div>
  </footer>

  <!-- FULLSCREEN OVERLAY -->
  <div id="player-overlay" class="fixed inset-0 bg-black bg-opacity-95 hidden flex flex-col items-center justify-center z-50">
    <button onclick="closePlayerOverlay()" class="absolute top-4 right-4 text-2xl">‚ùå</button>
    <img id="overlay-cover" src="" alt="cover" class="w-64 h-64 object-cover rounded-xl mb-6">
    <h2 id="overlay-song" class="text-2xl font-bold mb-2">Canci√≥n</h2>
    <p id="overlay-album" class="text-lg text-gray-400 mb-6">√Ålbum</p>
    <div class="flex space-x-6 text-5xl">
      <button onclick="prevSong(event)">‚èÆÔ∏è</button>
      <button onclick="togglePlay(event)" id="overlay-play-btn">‚ñ∂Ô∏è</button>
      <button onclick="nextSong(event)">‚è≠Ô∏è</button>
    </div>
  </div>

  <!-- AUDIO -->
  <audio id="audio-player"></audio>

  <script>
    const audio = document.getElementById("audio-player");
    const playerOverlay = document.getElementById("player-overlay");

    function openPlayerOverlay() {
      if (!currentSong) return;
      document.getElementById("overlay-cover").src = document.getElementById("player-cover").src;
      document.getElementById("overlay-song").innerText = document.getElementById("player-song").innerText;
      document.getElementById("overlay-album").innerText = document.getElementById("player-album").innerText;
      playerOverlay.classList.remove("hidden");
    }

    function closePlayerOverlay() {
      playerOverlay.classList.add("hidden");
    }

    // Aqu√≠ ir√≠a tu l√≥gica de cargar albums y canciones desde Supabase como ya lo ten√≠as
    let currentSong = null;

    function playSong(songUrl, coverUrl, title, album) {
      currentSong = songUrl;
      audio.src = songUrl;
      audio.play();
      document.getElementById("player-cover").src = coverUrl;
      document.getElementById("player-song").innerText = title;
      document.getElementById("player-album").innerText = album;
    }

    function togglePlay(event) {
      event.stopPropagation();
      if (audio.paused) {
        audio.play();
        document.getElementById("play-btn").innerText = "‚è∏Ô∏è";
        document.getElementById("overlay-play-btn").innerText = "‚è∏Ô∏è";
      } else {
        audio.pause();
        document.getElementById("play-btn").innerText = "‚ñ∂Ô∏è";
        document.getElementById("overlay-play-btn").innerText = "‚ñ∂Ô∏è";
      }
    }

    function prevSong(event) { event.stopPropagation(); alert("Canci√≥n anterior"); }
    function nextSong(event) { event.stopPropagation(); alert("Siguiente canci√≥n"); }
  </script>
</body>
</html>
