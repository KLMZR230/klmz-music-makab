<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="utf-8" />
  <title>KLMZ MUSIC</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="theme-color" content="#1DB954" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="mobile-web-app-capable" content="yes" />

  <!-- CSS -->
  <link rel="stylesheet" href="styles.css" />

  <!-- SDK Appwrite -->
  <script src="https://cdn.jsdelivr.net/npm/appwrite@13.0.1/dist/appwrite.umd.js"></script>
</head>

<body>
  <!-- Indicador de carga -->
  <div id="loading-indicator" class="loading-indicator" hidden>🎵 Cargando…</div>

  <!-- Encabezado -->
  <header>
    <span class="logo">KLMZ MUSIC</span>

    <div class="user-actions">
      <!-- Selector de tema -->
      <div class="theme-selector">
        <label for="theme-select">Tema:</label>
        <select id="theme-select" onchange="changeTheme(this.value)">
          <option value="default">🎵 Default</option>
          <option value="neon">⚡ Neon</option>
          <option value="minimal">✨ Minimal</option>
          <option value="sunset">🌅 Sunset</option>
          <option value="pastel">🌸 Pastel</option>
          <option value="luxury">💎 Luxury</option>
          <option value="oceanic">🌊 Oceanic</option>
        </select>
      </div>

      <!-- Menú de usuario -->
      <div class="user-menu">
        <div id="header-lock-icon" class="lock-icon" onclick="toggleUserMenu()">🔒</div>

        <div id="user-dropdown" class="user-dropdown">
          <div id="user-info-section" class="user-info" hidden>
            <div><strong id="user-email-display"></strong></div>
            <div id="user-role-display">Usuario</div>
          </div>

          <div id="admin-menu-item"  class="user-dropdown-item" onclick="goToAdmin()" hidden>⚙️ Panel Admin</div>
          <div id="register-menu-item" class="user-dropdown-item" onclick="showAuth('register')">📝 Registrarse</div>
          <div id="login-menu-item"    class="user-dropdown-item" onclick="showAuth('login')">🔐 Iniciar sesión</div>
          <div id="logout-menu-item"   class="user-dropdown-item logout" onclick="confirmLogout()" hidden>🚪 Cerrar sesión</div>
        </div>
      </div>
    </div>
  </header>

  <!-- Contenido principal -->
  <div class="app-container">
    <main>
      <!-- Inicio -->
      <section id="home-section" class="content-section active">
        <h2 class="section-title">Álbumes</h2>
        <div id="albums" class="album-grid">
          <div style="text-align:center;padding:2rem;">Cargando álbumes…</div>
        </div>
        <div id="album-detail" hidden></div>
      </section>

      <!-- Buscar -->
      <section id="search-section" class="content-section">
        <h2 class="section-title">Buscar música</h2>
        <input id="search-input" type="text" placeholder="¿Qué quieres escuchar?" />
      </section>

      <!-- Favoritos -->
      <section id="favorites-section" class="content-section">
        <h2 class="section-title">❤️ Mis Favoritos</h2>
      </section>

      <!-- Descargas -->
      <section id="downloads-section" class="content-section">
        <h2 class="section-title">↓ Mis Descargas</h2>
      </section>

      <!-- Panel Admin -->
      <section id="admin-section" class="content-section">
        <h2 class="section-title">Panel de Administración</h2>
        <div id="admin-content"></div>
      </section>
    </main>
  </div>

  <!-- Navegación inferior -->
  <nav class="bottom-nav">
    <div id="nav-home"      class="bottom-nav-item active" onclick="showSection('home')"     >⌂ Inicio      </div>
    <div id="nav-search"    class="bottom-nav-item"        onclick="showSection('search')"   >⌕ Buscar      </div>
    <div id="nav-downloads" class="bottom-nav-item"        onclick="showSection('downloads')">↓ Descargas   </div>
    <div id="nav-favs"      class="bottom-nav-item"        onclick="showSection('favorites')">♡ Favoritos   </div>
  </nav>

  <!-- Mini-player -->
  <div id="mini-player" class="player" hidden>
    <img id="mini-player-img"  class="player-img-mini" alt="cover" />
    <div class="player-info-mini">
      <div id="mini-player-title"  class="player-title-mini"></div>
      <div id="mini-player-artist" class="player-artist-mini"></div>
    </div>
    <button id="mini-play-btn" class="play-btn-inline" onclick="togglePlay()">▶</button>
  </div>

  <!-- Full-player -->
  <div id="full-player" class="full-player-backdrop">
    <button class="full-player-close" onclick="closeFullPlayer()">&times;</button>
    <img id="full-player-cover"  class="full-player-cover"  alt="cover" />
    <div id="full-player-title"  class="full-player-title" ></div>
    <div id="full-player-artist" class="full-player-artist"></div>

    <div class="full-player-controls">
      <div class="full-control-buttons">
        <button class="full-control-btn" onclick="previousSong()">⏮</button>
        <button id="full-play-btn" class="full-control-btn full-play-btn" onclick="togglePlay()">▶</button>
        <button class="full-control-btn" onclick="nextSong()">⏭</button>
      </div>

      <div class="mode-controls">
        <button id="repeat-btn"  class="mode-btn" onclick="toggleRepeatMode()">🔁</button>
        <button id="shuffle-btn" class="mode-btn" onclick="toggleShuffleMode()">🔀</button>
      </div>

      <div class="full-progress-container">
        <span id="full-current-time" class="full-progress-time">0:00</span>
        <div class="full-progress-bar" onclick="seekToFull(event)">
          <div id="full-progress-fill" class="full-progress-fill"></div>
        </div>
        <span id="full-total-time" class="full-progress-time">0:00</span>
      </div>

      <div class="full-player-volume">
        <input class="full-volume-slider" type="range" min="0" max="100" value="70" oninput="setVolume(this.value)" />
      </div>
    </div>
  </div>

  <!-- Modal de autenticación -->
  <div id="auth-modal" class="modal">
    <div class="modal-content">
      <button class="close-modal" onclick="closeAuth()">&times;</button>

      <!-- Formulario login -->
      <div id="login-form">
        <h2>Iniciar sesión</h2>
        <form onsubmit="login(event)">
          <div class="form-group"><label>Email:</label>      <input id="login-email"    type="email"    required /></div>
          <div class="form-group"><label>Contraseña:</label><input id="login-password" type="password" required /></div>
          <button class="btn-primary" type="submit">Iniciar sesión</button>
        </form>
        <p>¿No tienes cuenta? <a href="#" onclick="showAuth('register')">Regístrate</a></p>
      </div>

      <!-- Formulario registro -->
      <div id="register-form" hidden>
        <h2>Registrarse</h2>
        <form onsubmit="register(event)">
          <div class="form-group"><label>Email:</label>             <input id="register-email"           type="email"    required /></div>
          <div class="form-group"><label>Contraseña:</label>        <input id="register-password"        type="password" required /></div>
          <div class="form-group"><label>Confirmar contraseña:</label><input id="register-confirm-password" type="password" required /></div>
          <button class="btn-primary" type="submit">Registrarse</button>
        </form>
        <p>¿Ya tienes cuenta? <a href="#" onclick="showAuth('login')">Inicia sesión</a></p>
      </div>
    </div>
  </div>

  <!-- Audio oculto -->
  <audio id="audio-player" preload="metadata"></audio>

  <!-- Pie -->
  <footer class="copyright">
    © 2025 KLMZ MUSIC – Desarrollado por Freddy Granados
  </footer>

  <!-- JS principal -->
  <script src="app.js"></script>
</body>
</html>

